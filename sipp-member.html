<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SIPP Member Sign Up</title>

<style>
body{
  font-family:system-ui,-apple-system,Segoe UI,sans-serif;
  background:#f5f7fb;
  margin:0;
  padding:20px;
}
.container{max-width:900px;margin:0 auto}
.card{
  background:#fff;
  border-radius:16px;
  padding:20px;
  margin-bottom:16px;
  box-shadow:0 10px 22px rgba(0,0,0,.08);
}
h1,h2{margin-top:0}
label{display:block;font-weight:600;margin-top:12px}
input{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid #cbd5e1;
}
button{
  margin-top:20px;
  padding:12px 18px;
  border-radius:12px;
  border:none;
  background:#4f46e5;
  color:#fff;
  font-size:1rem;
  cursor:pointer;
}
.error{color:#b91c1c;margin-top:10px}
</style>
</head>

<body>
<div class="container">
<h1>Create SIPP Account</h1>

<form id="signup">

<div class="card">
<h2>Member details</h2>
<label>Email</label><input id="email" required>
<label>Password</label><input id="password" type="password" required>
<label>Full name</label><input id="full">
<label>NI number</label><input id="ni">
<label>Address line 1</label><input id="a1">
<label>Address line 2</label><input id="a2">
<label>City</label><input id="city">
<label>Postcode</label><input id="pc">
</div>

<div class="card">
<h2>Adviser firm</h2>
<label>Firm name</label><input id="firm">
<label>Address line 1</label><input id="fa1">
<label>Address line 2</label><input id="fa2">
<label>City</label><input id="fcity">
<label>Postcode</label><input id="fpc">
<label>Contact name</label><input id="fname">
<label>Contact email</label><input id="femail">
<label>Contact phone</label><input id="fphone">
</div>

<button>Create account</button>
<div class="error" id="err"></div>
</form>
</div>

<script>
const API = "https://haldred1.org/sipp_api.php";

document.getElementById("signup").addEventListener("submit", async e=>{
  e.preventDefault();
  err.textContent="";

  const body = {
    email: email.value,
    password: password.value,
    full_name: full.value,
    ni_number: ni.value,
    address_line1: a1.value,
    address_line2: a2.value,
    city: city.value,
    postcode: pc.value,

    adviser_firm_name: firm.value,
    adviser_address_line1: fa1.value,
    adviser_address_line2: fa2.value,
    adviser_city: fcity.value,
    adviser_postcode: fpc.value,
    adviser_contact_name: fname.value,
    adviser_contact_email: femail.value,
    adviser_contact_phone: fphone.value
  };

  try{
    const r = await fetch(API+"?action=member_register",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(body)
    });
    const out = await r.json();
    if(!r.ok) throw new Error(out.error);
    alert("Account created. SIPP ref: "+out.sipp_ref);
    location.href="sipp-login.html";
  }catch(e){
    err.textContent=e.message;
  }
});
</script>
</body>
</html>
